<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="author" content="智能社 - zhinengshe.com" />
<meta name="copyright" content="智能社 - zhinengshe.com" />
<title>智能社 - www.zhinengshe.com</title>
<style>
#div1{ position:absolute;left:0;top:0; width:200px; height:200px; background:#ccc;}
#div2{ position:absolute;left:500px;top:250px; width:200px; height:200px; background:green;}
</style>
<script>

window.onload = function(){
	
	var oDiv1 = document.getElementById("div1");
	var oDiv2 = document.getElementById("div2");
	
	oDiv1.onmousedown = function(ev){
		var oEvent = ev || event;
		
		var disX = oEvent.clientX - oDiv1.offsetLeft;
		var disY = oEvent.clientY - oDiv1.offsetTop;
		
		document.onmousemove = function(ev){
			var oEvent = ev || event;
			
			oDiv1.style.left = oEvent.clientX - disX + "px";
			oDiv1.style.top  = oEvent.clientY - disY + "px";
			
			if(collTest(oDiv1,oDiv2)){//碰上了
				oDiv2.style.background = "red";
			} else {//没碰上
				oDiv2.style.background = "green";
			}
			
			
		};
		
		document.onmouseup = function(){
			document.onmousemove = null;
			document.onmouseup = null;
			oDiv1.releaseCapture && oDiv1.releaseCapture();
		};
		
		oDiv1.setCapture && oDiv1.setCapture();
		return false;
		
	};
	
	function collTest(obj1,obj2){
		
		var l1 = obj1.offsetLeft;
		var t1 = obj1.offsetTop;
		var r1 = l1 + obj1.offsetWidth;
		var b1 = t1 + obj1.offsetHeight;
		
		
		var l2 = obj2.offsetLeft;
		var t2 = obj2.offsetTop;
		var r2 = l2 + obj2.offsetWidth;
		var b2 = t2 + obj2.offsetHeight;
		
		if(r1 < l2 || b1 < t2 || l1 > r2 || t1 > b2){//没碰到
			return false;
		} else {//碰到了
			return true;
		}
	}
	
	
	
};

</script>
</head>

<body>
<div id="div1"></div>
<div id="div2"></div>
</body>
</html>
