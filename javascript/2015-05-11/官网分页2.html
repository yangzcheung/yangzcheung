<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="author" content="智能社 - zhinengshe.com" />
<meta name="copyright" content="智能社 - zhinengshe.com" />
<title>智能社 - www.zhinengshe.com</title>
<style>
*{margin:0;padding:0;list-style:none;}
#ul1{ position:relative; width:516px; margin:30px auto;}
#ul1 li{float:left;width:150px; height:150px; border:1px solid #000; margin:10px; background:#ccc; opacity:1;filter:alpha(opacity:100);}

</style>
<script src="move.js"></script>
<script>

window.onload = function(){
	
	var oBtn = document.getElementById("btn1");
	var oUl = document.getElementById("ul1");
	var aLi = oUl.children;
	var len = aLi.length;
	
	//布局转换
	var aPos = [];
	for(var i = 0; i < len; i++){
		aPos[i] = {
			left:aLi[i].offsetLeft,top:aLi[i].offsetTop,
		    width:aLi[i].offsetWidth,height:aLi[i].offsetHeight,
		    opacity:1
		};
		aLi[i].style.left = aPos[i].left + "px";
		aLi[i].style.top  = aPos[i].top + "px";
	}
	
	for(var i = 0; i < len; i++){
		aLi[i].style.position = "absolute";
		aLi[i].style.margin  = "0";
	}
	
	//收起来
	var i = 0;
	var timer = null;
	oBtn.onclick = function(){
		clearInterval(timer);
		if(i<len-1){
			timer = setInterval(function(){
				
				(function(index){
					move(aLi[i],{left:0,top:0,width:50,height:50,opacity:0},{complete:function(){
						 
						if(index == len - 1){
							//alert("over");	
							i = index;
							clearInterval(timer);
						}
							
					}});
				})(i);/* end fn ()(); */
				
				i++;
				if(i == len){
					clearInterval(timer);
				}
					
			},100);
		}else{
			timer = setInterval(function(){
				
				move(aLi[i],aPos[i]);
				
				i--;
				if(i == -1){
					clearInterval(timer);
					i=0;
				}
					
			},100);
						
		}
	};/* end fn onclick */
};

</script>
</head>

<body>
<input id="btn1" type="button" value="收起来！"/>
<ul id="ul1">
	<li></li>
	<li></li>
	<li></li>
	<li></li>
	<li></li>
	<li></li>
	<li></li>
	<li></li>
	<li></li>
</ul>
</body>
</html>
